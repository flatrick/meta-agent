{
  "tasks": [
    {
      "name": "configure_existing_repo_success",
      "description": "Existing-repo onboarding path succeeds without scaffolding templates.",
      "expected_exit_code": 0,
      "args": [
        "configure",
        "--repo",
        "{workspace_dir}/existing-repo",
        "--policy",
        "{policy_path}",
        "--requested-autonomy",
        "A1",
        "--mode",
        "hybrid",
        "--tokens-requested",
        "20",
        "--tickets-requested",
        "1",
        "--open-prs",
        "0",
        "--output",
        "{artifacts_dir}/configure",
        "--decision-record",
        "{artifacts_dir}/configure/decision.json",
        "--workflow-record",
        "{artifacts_dir}/configure/workflow.json",
        "--run-result",
        "{artifacts_dir}/configure/run_result.json",
        "--metrics-scoreboard",
        "{metrics_path}"
      ]
    },
    {
      "name": "init_success",
      "description": "Mutating init path succeeds with policy gates and emits artifacts.",
      "expected_exit_code": 0,
      "args": [
        "init",
        "--template",
        "generic",
        "--target",
        "{workspace_dir}/scaffolded-service",
        "--name",
        "harness-service",
        "--policy",
        "{policy_path}",
        "--requested-autonomy",
        "A1",
        "--mode",
        "hybrid",
        "--tokens-requested",
        "42",
        "--tickets-requested",
        "1",
        "--open-prs",
        "0",
        "--output",
        "{artifacts_dir}/init",
        "--decision-record",
        "{artifacts_dir}/init/decision.json",
        "--workflow-record",
        "{artifacts_dir}/init/workflow.json",
        "--run-result",
        "{artifacts_dir}/init/run_result.json",
        "--metrics-scoreboard",
        "{metrics_path}"
      ]
    },
    {
      "name": "validate_success",
      "description": "Validate command succeeds and appends metrics/run-result output.",
      "expected_exit_code": 0,
      "args": [
        "validate",
        "--policy",
        "{policy_path}",
        "--requested-autonomy",
        "A1",
        "--mode",
        "hybrid",
        "--output",
        "{artifacts_dir}/validate",
        "--decision-record",
        "{artifacts_dir}/validate/decision.json",
        "--workflow-record",
        "{artifacts_dir}/validate/workflow.json",
        "--run-result",
        "{artifacts_dir}/validate/run_result.json",
        "--metrics-scoreboard",
        "{metrics_path}"
      ]
    },
    {
      "name": "validate_ambiguity_blocked",
      "description": "Validate command blocks with unresolved ambiguity (exit 6).",
      "expected_exit_code": 6,
      "args": [
        "validate",
        "--policy",
        "{policy_path}",
        "--requested-autonomy",
        "A1",
        "--mode",
        "hybrid",
        "--ambiguity-score",
        "0.95",
        "--output",
        "{artifacts_dir}/validate-ambiguity",
        "--decision-record",
        "{artifacts_dir}/validate-ambiguity/decision.json",
        "--workflow-record",
        "{artifacts_dir}/validate-ambiguity/workflow.json",
        "--run-result",
        "{artifacts_dir}/validate-ambiguity/run_result.json",
        "--metrics-scoreboard",
        "{metrics_path}"
      ]
    },
    {
      "name": "triage_ineligible",
      "description": "Triage ineligible ticket path returns exit 8 and records evidence.",
      "expected_exit_code": 8,
      "args": [
        "triage",
        "--ticket",
        "fix typo",
        "--output",
        "{artifacts_dir}/triage/ineligible.json",
        "--run-result",
        "{artifacts_dir}/triage/run_result.json",
        "--metrics-scoreboard",
        "{metrics_path}"
      ]
    }
  ]
}
